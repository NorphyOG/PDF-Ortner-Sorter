<Window x:Class="PDFOrtnerSorter.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModels="clr-namespace:PDFOrtnerSorter.ViewModels"
        xmlns:infra="clr-namespace:PDFOrtnerSorter.Infrastructure"
        xmlns:md="http://materialdesigninxaml.com/winfx/xaml/themes"
        mc:Ignorable="d"
        Title="PDF Ortner Sorter"
        Width="1920"
        Height="1080"
        MinWidth="1024"
        MinHeight="720"
        Background="{DynamicResource AppBackground}"
        Foreground="White"
        FontFamily="Segoe UI">
    <Window.Resources>
        <LinearGradientBrush x:Key="AppBackground" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#040914" Offset="0"/>
            <GradientStop Color="#0e213b" Offset="0.35"/>
            <GradientStop Color="#04060a" Offset="1"/>
        </LinearGradientBrush>
        <SolidColorBrush x:Key="CardBrush" Color="#131d31"/>
        <SolidColorBrush x:Key="PrimaryBlueBrush" Color="#2563eb"/>
        <SolidColorBrush x:Key="AccentCyanBrush" Color="#06b6d4"/>
        <LinearGradientBrush x:Key="AccentBrush" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#8ef6d2" Offset="0"/>
            <GradientStop Color="#4ade80" Offset="1"/>
        </LinearGradientBrush>
        <LinearGradientBrush x:Key="AccentBrushDark" StartPoint="0,0" EndPoint="1,1">
            <GradientStop Color="#66d49f" Offset="0"/>
            <GradientStop Color="#34c46c" Offset="1"/>
        </LinearGradientBrush>
        <SolidColorBrush x:Key="TextSecondaryBrush" Color="#cbd5f5"/>
        <SolidColorBrush x:Key="GhostBorderBrush" Color="#2a3244"/>
        <SolidColorBrush x:Key="GhostHoverBrush" Color="#343f55"/>
        <SolidColorBrush x:Key="WarningBrush" Color="#f59e0b"/>

        <infra:ThumbnailFirstConverter x:Key="ThumbnailFirstConverter" />
        <infra:BytesConverter x:Key="BytesConverter" />

        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="{StaticResource CardBrush}"/>
            <Setter Property="CornerRadius" Value="14"/>
            <Setter Property="Padding" Value="14"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" BlurRadius="26" ShadowDepth="0" Opacity="0.3"/>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="AccentButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="#04101f"/>
            <Setter Property="Padding" Value="18,10"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="SnapsToDevicePixels" Value="True"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" CornerRadius="12">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="#000000" BlurRadius="20" ShadowDepth="0" Opacity="0.35"/>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource AccentBrushDark}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#2fa95d"/>
                </Trigger>
                <Trigger Property="IsEnabled" Value="False">
                    <Setter Property="Opacity" Value="0.4"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="GhostButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#10182b"/>
            <Setter Property="BorderBrush" Value="{StaticResource GhostBorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="Padding" Value="18,10"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border Background="{TemplateBinding Background}" BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" CornerRadius="12">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="{StaticResource GhostHoverBrush}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background" Value="#202a3f"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="CardToolbarButtonStyle" TargetType="Button" BasedOn="{StaticResource GhostButtonStyle}">
            <Setter Property="Padding" Value="12,6"/>
        </Style>

        <BooleanToVisibilityConverter x:Key="BoolToVisibility" />
        <infra:BooleanToTextConverter x:Key="BoolToTextConverter" TrueText="Ja" FalseText="Nein" />
    </Window.Resources>

    <Grid Margin="24">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <!-- Header -->
        <Grid Grid.Row="0" Margin="0,0,0,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>
            <StackPanel>
                <TextBlock Text="PDF Ortner Sorter" FontSize="32" FontWeight="SemiBold" />
                <TextBlock Text="Sortiere massenhaft gescannte PDFs mit drei Klicks â€“ Vorschau, Auswahl, Move."
                           Foreground="{StaticResource TextSecondaryBrush}" Margin="0,4,0,0" />
            </StackPanel>
            <StackPanel Grid.Column="1" Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="Einstellungen"
                    Command="{Binding OpenSettingsCommand}"
                    Margin="0,0,12,0"
                    Style="{StaticResource GhostButtonStyle}" />
                <Button Content="Aktualisieren"
                        Command="{Binding RefreshCommand}"
                        Margin="0,0,12,0"
                        Style="{StaticResource GhostButtonStyle}" />
                <Button Content="Etiketten drucken"
                        Command="{Binding PrintLabelsCommand}"
                        Margin="0,0,12,0"
                        Style="{StaticResource GhostButtonStyle}" />
                <Button Content="Job erstellen"
                        Command="{Binding CreateJobCommand}"
                        Style="{StaticResource AccentButtonStyle}" />
            </StackPanel>
        </Grid>

        <!-- Main Content -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="280" />
                <ColumnDefinition Width="1*" />
                <ColumnDefinition Width="340" />
            </Grid.ColumnDefinitions>

            <!-- Left Sidebar: Workflow -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,16,0">
                <StackPanel>
                    <!-- Step 1: Quellordner -->
                    <Border Style="{StaticResource CardStyle}" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="â‘ " FontSize="20" FontWeight="Bold" Foreground="#4ade80" Margin="0,0,8,0" VerticalAlignment="Center" />
                            <StackPanel>
                                <TextBlock Text="Quellordner" FontWeight="SemiBold" FontSize="14" />
                                <TextBlock Text="WÃ¤hle den Ordner mit gescannten PDFs" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" Margin="0,2,0,0" />
                            </StackPanel>
                        </StackPanel>
                        <Separator Margin="0,8,0,8" />
                        
                        <TextBlock Text="{Binding SourceFolder, TargetNullValue='ðŸ”´ Kein Ordner ausgewÃ¤hlt'}" 
                                   TextWrapping="Wrap" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   FontSize="10" 
                                   Margin="0,0,0,8" />
                        
                        <Button Content="ðŸ“ Quellordner durchsuchen..."
                                Command="{Binding BrowseSourceCommand}"
                                Style="{StaticResource GhostButtonStyle}"
                                HorizontalAlignment="Stretch"
                                Padding="10,8" />
                    </StackPanel>
                </Border>

                <!-- Step 2: Dateien -->
                <Border Style="{StaticResource CardStyle}" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="â‘¡" FontSize="20" FontWeight="Bold" Foreground="#4ade80" Margin="0,0,8,0" VerticalAlignment="Center" />
                            <StackPanel>
                                <TextBlock Text="Dateien auswÃ¤hlen" FontWeight="SemiBold" FontSize="14" />
                                <TextBlock Text="Markiere PDFs zum Verschieben" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" Margin="0,2,0,0" />
                            </StackPanel>
                        </StackPanel>
                        <Separator Margin="0,8,0,8" />
                        
                        <TextBlock Margin="0,0,0,8">
                            <Run Text="Gefunden: " Foreground="{StaticResource TextSecondaryBrush}" />
                            <Run Text="{Binding DocumentsCount}" FontWeight="Bold" Foreground="#4ade80" />
                            <Run Text=" | AusgewÃ¤hlt: " Foreground="{StaticResource TextSecondaryBrush}" />
                            <Run Text="{Binding SelectedCount}" FontWeight="Bold" Foreground="#06b6d4" />
                        </TextBlock>
                        
                        <Button Content="âœ“ Alle markieren"
                                Command="{Binding SelectAllDocumentsCommand}"
                                Style="{StaticResource GhostButtonStyle}"
                                HorizontalAlignment="Stretch"
                                Padding="10,6"
                                Margin="0,0,0,6" />
                        <Button Content="âœ— Auswahl leeren"
                                Command="{Binding ClearSelectionCommand}"
                                Style="{StaticResource GhostButtonStyle}"
                                HorizontalAlignment="Stretch"
                                Padding="10,6" />
                    </StackPanel>
                </Border>

                <!-- Step 3: Zielordner & Ordnername -->
                <Border Style="{StaticResource CardStyle}" Padding="16" Margin="0,0,0,12">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="â‘¢" FontSize="20" FontWeight="Bold" Foreground="#4ade80" Margin="0,0,8,0" VerticalAlignment="Center" />
                            <StackPanel>
                                <TextBlock Text="Zielordner" FontWeight="SemiBold" FontSize="14" />
                                <TextBlock Text="WÃ¤hle Basis und Namen" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" Margin="0,2,0,0" />
                            </StackPanel>
                        </StackPanel>
                        <Separator Margin="0,8,0,8" />
                        
                        <TextBlock Text="Zielbasis" FontWeight="SemiBold" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4" />
                        <TextBlock Text="{Binding DestinationBaseFolder, TargetNullValue='ðŸ”´ Nicht gewÃ¤hlt'}" 
                                   TextWrapping="Wrap" 
                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                   FontSize="10" 
                                   Margin="0,0,0,8" />
                        
                        <Button Content="ðŸ“ Zielordner durchsuchen..."
                                Command="{Binding BrowseDestinationCommand}"
                                Style="{StaticResource GhostButtonStyle}"
                                HorizontalAlignment="Stretch"
                                Padding="10,8"
                                Margin="0,0,0,12" />
                        
                        <TextBlock Text="Ordnername (mit Autovorschlag)" FontWeight="SemiBold" FontSize="11" Foreground="{StaticResource TextSecondaryBrush}" Margin="0,0,0,4" />
                        <Grid Margin="0,0,0,12">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <TextBox x:Name="FolderNameTextBox"
                                     Grid.Row="0"
                                     Text="{Binding DestinationFolderName, UpdateSourceTrigger=PropertyChanged}" 
                                     Padding="8"
                                     Background="#0f172a"
                                     Foreground="White"
                                     BorderBrush="{StaticResource GhostBorderBrush}"
                                     BorderThickness="1" />
                            
                            <!-- AutoComplete Suggestions -->
                            <Border Grid.Row="1" 
                                    Background="#0a0e1a" 
                                    BorderBrush="{StaticResource GhostBorderBrush}"
                                    BorderThickness="1,0,1,1"
                                    Visibility="{Binding FolderNameSuggestions.Count, Converter={StaticResource BoolToVisibility}}">
                                <ListBox ItemsSource="{Binding FolderNameSuggestions}"
                                         Background="Transparent"
                                         BorderThickness="0"
                                         MaxHeight="120"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <TextBlock Text="{Binding}"
                                                       Padding="8,4"
                                                       Cursor="Hand"
                                                       Foreground="{StaticResource TextSecondaryBrush}"
                                                       MouseDown="OnSuggestionMouseDown" />
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                    <ListBox.ItemContainerStyle>
                                        <Style TargetType="ListBoxItem">
                                            <Setter Property="Background" Value="Transparent"/>
                                            <Setter Property="Padding" Value="0"/>
                                            <Setter Property="Margin" Value="0"/>
                                            <Style.Triggers>
                                                <Trigger Property="IsMouseOver" Value="True">
                                                    <Setter Property="Background" Value="#162239"/>
                                                </Trigger>
                                            </Style.Triggers>
                                        </Style>
                                    </ListBox.ItemContainerStyle>
                                </ListBox>
                            </Border>
                        </Grid>
                    </StackPanel>
                </Border>

                <!-- Step 4: Zusammenfassung & Job erstellen -->
                <Border Style="{StaticResource CardStyle}" Padding="16">
                    <StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="â‘£" FontSize="20" FontWeight="Bold" Foreground="#4ade80" Margin="0,0,8,0" VerticalAlignment="Center" />
                            <StackPanel>
                                <TextBlock Text="Job erstellen" FontWeight="SemiBold" FontSize="14" />
                                <TextBlock Text="Starte den Verschiebungsprozess" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" Margin="0,2,0,0" />
                            </StackPanel>
                        </StackPanel>
                        <Separator Margin="0,8,0,8" />
                        
                        <TextBlock Margin="0,0,0,8" FontSize="10">
                            <Run Text="âœ“ " Foreground="#4ade80" />
                            <Run Text="{Binding SelectedCount}" FontWeight="Bold" />
                            <Run Text=" Dateien" />
                            <Run Text=" â†’ " Foreground="{StaticResource TextSecondaryBrush}" />
                            <Run Text="{Binding DestinationFolderName}" FontWeight="Bold" Foreground="#06b6d4" />
                        </TextBlock>
                        
                        <Button Content="ðŸš€ Job erstellen &amp; starten"
                                Command="{Binding CreateJobCommand}"
                                Style="{StaticResource AccentButtonStyle}"
                                HorizontalAlignment="Stretch"
                                Padding="10,10"
                                FontSize="13"
                                FontWeight="SemiBold" />
                    </StackPanel>
                </Border>

                <!-- Status -->
                <Border Style="{StaticResource CardStyle}" Padding="16" Margin="0,12,0,0">
                    <StackPanel>
                        <TextBlock Text="Status" FontWeight="SemiBold" FontSize="12" Margin="0,0,0,8" />
                        <TextBlock Text="{Binding StatusMessage}" TextWrapping="Wrap" Foreground="{StaticResource TextSecondaryBrush}" FontSize="10" />
                    </StackPanel>
                </Border>
            </StackPanel>
            </ScrollViewer>

            <!-- Middle: File List -->
            <Border Grid.Column="1" Style="{StaticResource CardStyle}" Margin="0,0,16,0">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <StackPanel Grid.Row="0" Margin="0,0,0,12">
                        <TextBlock Text="Dateien" FontSize="16" FontWeight="SemiBold" Margin="0,0,0,8" />
                        <TextBlock>
                            <Run Text="Gefunden: " Foreground="{StaticResource TextSecondaryBrush}" />
                            <Run Text="{Binding DocumentsCount}" FontWeight="Bold" Foreground="#4ade80" />
                            <Run Text=" | AusgewÃ¤hlt: " Foreground="{StaticResource TextSecondaryBrush}" />
                            <Run Text="{Binding SelectedCount}" FontWeight="Bold" Foreground="#06b6d4" />
                        </TextBlock>
                    </StackPanel>

                    <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                        <ItemsControl ItemsSource="{Binding Documents}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <Border x:Name="FileItemBorder"
                                            Padding="8" 
                                            CornerRadius="6" 
                                            BorderBrush="#21304a" 
                                            BorderThickness="1" 
                                            Margin="0,0,0,4"
                                            Background="#162239"
                                            Cursor="Hand">
                                        <Border.InputBindings>
                                            <MouseBinding MouseAction="LeftClick" 
                                                         Command="{Binding RelativeSource={RelativeSource AncestorType=Window}, Path=DataContext.ToggleFileSelectionCommand}" 
                                                         CommandParameter="{Binding}" />
                                        </Border.InputBindings>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto" />
                                                <ColumnDefinition Width="32" />
                                                <ColumnDefinition Width="*" />
                                                <ColumnDefinition Width="Auto" />
                                            </Grid.ColumnDefinitions>

                                            <!-- Checkbox -->
                                            <CheckBox Grid.Column="0" 
                                                      IsChecked="{Binding IsSelected}" 
                                                      VerticalAlignment="Center"
                                                      Margin="0,0,6,0"
                                                      IsHitTestVisible="False" />

                                            <!-- Thumbnail -->
                                            <Border Grid.Column="1" 
                                                    Background="#0f172a" 
                                                    BorderBrush="#2a3244" 
                                                    BorderThickness="1"
                                                    CornerRadius="4">
                                                <Image Source="{Binding Thumbnails, Converter={StaticResource ThumbnailFirstConverter}}" 
                                                       Stretch="UniformToFill"
                                                       Opacity="0.9" />
                                            </Border>

                                            <!-- File Info -->
                                            <StackPanel Grid.Column="2" VerticalAlignment="Center" Margin="8,0,0,0">
                                                <TextBlock Text="{Binding FileName}" 
                                                           FontWeight="SemiBold" 
                                                           FontSize="11"
                                                           TextTrimming="CharacterEllipsis"
                                                           Foreground="White" />
                                                <StackPanel Orientation="Horizontal" Margin="0,2,0,0">
                                                    <TextBlock Text="{Binding FileSize, Converter={StaticResource BytesConverter}}" 
                                                               Foreground="{StaticResource TextSecondaryBrush}" 
                                                               FontSize="9" />
                                                    <TextBlock Text=" â€¢ " 
                                                               Foreground="{StaticResource TextSecondaryBrush}" 
                                                               FontSize="9"
                                                               Margin="4,0" />
                                                    <TextBlock Text="{Binding LastModified, StringFormat='{}dd.MM.yyyy HH:mm'}" 
                                                               Foreground="{StaticResource TextSecondaryBrush}" 
                                                               FontSize="9" />
                                                </StackPanel>
                                            </StackPanel>

                                            <!-- Selection Status Icon -->
                                            <TextBlock Grid.Column="3" 
                                                       Text="âœ“" 
                                                       Foreground="#06b6d4"
                                                       FontSize="14"
                                                       FontWeight="Bold"
                                                       VerticalAlignment="Center"
                                                       Margin="8,0,0,0"
                                                       Visibility="{Binding IsSelected, Converter={StaticResource BoolToVisibility}}" />
                                        </Grid>
                                    </Border>
                                    <DataTemplate.Triggers>
                                        <DataTrigger Binding="{Binding IsSelected}" Value="True">
                                            <Setter TargetName="FileItemBorder" Property="Background" Value="#1f3a4a" />
                                            <Setter TargetName="FileItemBorder" Property="BorderBrush" Value="#06b6d4" />
                                            <Setter TargetName="FileItemBorder" Property="BorderThickness" Value="2" />
                                        </DataTrigger>
                                    </DataTemplate.Triggers>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>
                    </ScrollViewer>

                    <!-- Empty State -->
                    <TextBlock Grid.Row="1" 
                               Text="Keine Dateien gefunden" 
                               FontSize="14" 
                               Foreground="{StaticResource TextSecondaryBrush}" 
                               HorizontalAlignment="Center" 
                               VerticalAlignment="Center"
                               Visibility="{Binding DocumentsCount, Converter={StaticResource BoolToVisibility}}" />
                </Grid>
            </Border>

            <!-- Right: Job Queue -->
            <Grid Grid.Column="2">
                <TabControl SelectedIndex="{Binding SelectedTabIndex}" Background="Transparent" BorderThickness="0">
                    <TabControl.Resources>
                        <Style TargetType="TabItem">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate TargetType="TabItem">
                                        <Border Name="Border" BorderThickness="1" BorderBrush="{StaticResource GhostBorderBrush}" Background="#10182b" CornerRadius="12,12,0,0" Padding="20,12" Margin="0,0,4,0">
                                            <ContentPresenter ContentSource="Header" />
                                        </Border>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter TargetName="Border" Property="Background" Value="{StaticResource CardBrush}" />
                                                <Setter TargetName="Border" Property="BorderBrush" Value="{StaticResource AccentCyanBrush}" />
                                            </Trigger>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Border" Property="Background" Value="{StaticResource GhostHoverBrush}" />
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                            <Setter Property="Foreground" Value="White" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </TabControl.Resources>

                    <!-- Tab 1: Running Jobs -->
                    <TabItem Header="Laufende Jobs">
                        <Border Style="{StaticResource CardStyle}" Padding="20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="Aktive und wartende Jobs" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,16" />

                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding RunningJobs}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#162239" Padding="16" CornerRadius="10" BorderBrush="#21304a" BorderThickness="1" Margin="0,0,0,12" Cursor="Hand">
                                                    <Border.InputBindings>
                                                        <MouseBinding MouseAction="LeftClick" Command="{Binding DataContext.ShowJobDetailsCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" />
                                                    </Border.InputBindings>
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>

                                                        <!-- Header: Name + Status -->
                                                        <Grid Grid.Row="0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Grid.Column="0" Text="{Binding FolderName}" FontSize="16" FontWeight="SemiBold" />
                                                            <TextBlock Grid.Column="1" Text="{Binding Status}" Foreground="#f59e0b" FontWeight="SemiBold" />
                                                        </Grid>

                                                        <!-- File count and overall progress -->
                                                        <TextBlock Grid.Row="1" Margin="0,8,0,4">
                                                            <Run Text="Dateien: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding TotalFileCount, Mode=OneWay}" FontWeight="SemiBold" />
                                                            <Run Text=" | Erfolg: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding SuccessfulFileCount, Mode=OneWay}" Foreground="#4ade80" FontWeight="SemiBold" />
                                                            <Run Text=" | Fehler: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding FailedFileCount, Mode=OneWay}" Foreground="#ef4444" FontWeight="SemiBold" />
                                                        </TextBlock>

                                                        <!-- Overall Progress Label -->
                                                        <TextBlock Grid.Row="2" Margin="0,0,0,4">
                                                            <Run Text="Gesamtfortschritt: " Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" />
                                                            <Run Text="{Binding ProgressPercentage, StringFormat={}{0:F1}%, Mode=OneWay}" FontWeight="SemiBold" FontSize="11" />
                                                        </TextBlock>

                                                        <!-- Overall Progress Bar -->
                                                        <ProgressBar Grid.Row="3" Minimum="0" Maximum="100" Value="{Binding ProgressPercentage}" Height="6" Background="#0f172a" BorderThickness="0" Foreground="#8ef6d2" />

                                                        <!-- Bytes transferred info -->
                                                        <TextBlock Grid.Row="4" Margin="0,8,0,4" FontSize="11">
                                                            <Run Text="Ãœbertragen: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding BytesTransferred, Converter={StaticResource BytesConverter}, Mode=OneWay}" FontWeight="SemiBold" Foreground="#06b6d4" />
                                                            <Run Text=" / " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding TotalBytes, Converter={StaticResource BytesConverter}, Mode=OneWay}" FontWeight="SemiBold" />
                                                        </TextBlock>

                                                        <!-- Created timestamp -->
                                                        <TextBlock Grid.Row="5" Text="{Binding CreatedAt, StringFormat='{}Gestartet: {0:dd.MM.yyyy HH:mm:ss}'}" Foreground="{StaticResource TextSecondaryBrush}" FontSize="10" />
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>

                                <!-- Empty State -->
                                <TextBlock Grid.Row="1" Text="Keine laufenden Jobs" 
                                           FontSize="16" 
                                           Foreground="{StaticResource TextSecondaryBrush}" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Visibility="{Binding RunningJobs.Count, Converter={StaticResource BoolToVisibility}}" />
                            </Grid>
                        </Border>
                    </TabItem>

                    <!-- Tab 2: Completed Jobs -->
                    <TabItem Header="Abgeschlossene Jobs">
                        <Border Style="{StaticResource CardStyle}" Padding="20">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto" />
                                    <RowDefinition Height="*" />
                                    <RowDefinition Height="Auto" />
                                </Grid.RowDefinitions>

                                <TextBlock Grid.Row="0" Text="Fertiggestellte Jobs" FontSize="20" FontWeight="SemiBold" Margin="0,0,0,16" />

                                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                                    <ItemsControl ItemsSource="{Binding CompletedJobs}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <Border Background="#162239" Padding="16" CornerRadius="10" BorderBrush="#21304a" BorderThickness="1" Margin="0,0,0,12" Cursor="Hand">
                                                    <Border.InputBindings>
                                                        <MouseBinding MouseAction="LeftClick" Command="{Binding DataContext.ShowJobDetailsCommand, RelativeSource={RelativeSource AncestorType=Window}}" CommandParameter="{Binding}" />
                                                    </Border.InputBindings>
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                            <RowDefinition Height="Auto" />
                                                        </Grid.RowDefinitions>

                                                        <Grid Grid.Row="0">
                                                            <Grid.ColumnDefinitions>
                                                                <ColumnDefinition Width="*" />
                                                                <ColumnDefinition Width="Auto" />
                                                            </Grid.ColumnDefinitions>
                                                            <TextBlock Grid.Column="0" Text="{Binding FolderName}" FontSize="16" FontWeight="SemiBold" />
                                                            <TextBlock Grid.Column="1" Text="Abgeschlossen" Foreground="#4ade80" FontWeight="SemiBold" />
                                                        </Grid>

                                                        <TextBlock Grid.Row="1" Margin="0,4,0,8">
                                                            <Run Text="Erfolgreich: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding SuccessfulFileCount, Mode=OneWay}" Foreground="#4ade80" FontWeight="SemiBold" />
                                                            <Run Text=" | Fehler: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding FailedFileCount, Mode=OneWay}" Foreground="#ef4444" FontWeight="SemiBold" />
                                                            <Run Text=" | Gesamt: " Foreground="{StaticResource TextSecondaryBrush}" />
                                                            <Run Text="{Binding TotalFileCount, Mode=OneWay}" FontWeight="SemiBold" />
                                                        </TextBlock>

                                                        <TextBlock Grid.Row="2" Text="{Binding CompletedAt, StringFormat='{}Abgeschlossen: {0:dd.MM.yyyy HH:mm:ss}'}" 
                                                                   Foreground="{StaticResource TextSecondaryBrush}" 
                                                                   FontSize="11" />
                                                    </Grid>
                                                </Border>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </ScrollViewer>

                                <!-- Load More Button -->
                                <Button Grid.Row="2" 
                                        Content="Mehr laden" 
                                        Command="{Binding LoadMoreJobsCommand}"
                                        Visibility="{Binding HasMoreCompletedJobs, Converter={StaticResource BoolToVisibility}}"
                                        Style="{StaticResource GhostButtonStyle}"
                                        HorizontalAlignment="Center"
                                        Margin="0,16,0,0" />

                                <!-- Empty State -->
                                <TextBlock Grid.Row="1" Text="Keine abgeschlossenen Jobs" 
                                           FontSize="16" 
                                           Foreground="{StaticResource TextSecondaryBrush}" 
                                           HorizontalAlignment="Center" 
                                           VerticalAlignment="Center"
                                           Visibility="{Binding CompletedJobs.Count, Converter={StaticResource BoolToVisibility}}" />
                            </Grid>
                        </Border>
                    </TabItem>
                </TabControl>
            </Grid>
        </Grid>

        <!-- Footer -->
        <DockPanel Grid.Row="2" Margin="0,8,0,0" LastChildFill="False">
            <TextBlock DockPanel.Dock="Left" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" />
            <Border Background="#111827" Padding="10,4" CornerRadius="8" DockPanel.Dock="Right">
                <TextBlock Text="Â© 2025 PDF Ortner Sorter Â· made by Norphy" Foreground="{StaticResource TextSecondaryBrush}" FontSize="11" />
            </Border>
        </DockPanel>
    </Grid>
</Window>
