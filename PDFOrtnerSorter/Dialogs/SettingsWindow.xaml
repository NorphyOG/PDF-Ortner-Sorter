<Window x:Class="PDFOrtnerSorter.Dialogs.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:sys="clr-namespace:System;assembly=System.Runtime"
        xmlns:infra="clr-namespace:PDFOrtnerSorter.Infrastructure"
        Title="Einstellungen"
        Width="800"
        Height="700"
        MaxHeight="750"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize"
        Background="#0f172a"
        Foreground="White"
        FontFamily="Segoe UI"
        WindowStyle="ToolWindow"
        MinWidth="740"
        MinHeight="600">
    <Window.Resources>
        <infra:BoolToOpacityConverter x:Key="BoolToOpacity" />
        <Style x:Key="DialogInputTextBoxStyle" TargetType="TextBox">
            <Setter Property="Background" Value="#0f172a" />
            <Setter Property="BorderBrush" Value="#233044" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="Padding" Value="10" />
        </Style>
        <Style x:Key="DialogComboBoxStyle" TargetType="ComboBox">
            <Setter Property="Background" Value="White" />
            <Setter Property="BorderBrush" Value="#3b82f6" />
            <Setter Property="BorderThickness" Value="2" />
            <Setter Property="Foreground" Value="Black" />
            <Setter Property="Padding" Value="10" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <Setter Property="ItemContainerStyle">
                <Setter.Value>
                    <Style TargetType="ComboBoxItem">
                        <Setter Property="Background" Value="White" />
                        <Setter Property="Foreground" Value="Black" />
                        <Setter Property="Padding" Value="10,8" />
                        <Setter Property="FontWeight" Value="SemiBold" />
                        <Style.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter Property="Background" Value="#e0f2fe" />
                                <Setter Property="Foreground" Value="#0c4a6e" />
                            </Trigger>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Background" Value="#bae6fd" />
                                <Setter Property="Foreground" Value="#0c4a6e" />
                            </Trigger>
                        </Style.Triggers>
                    </Style>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="BorderBrush" Value="#60a5fa" />
                    <Setter Property="Background" Value="#f0f9ff" />
                </Trigger>
                <Trigger Property="IsDropDownOpen" Value="True">
                    <Setter Property="BorderBrush" Value="#60a5fa" />
                </Trigger>
            </Style.Triggers>
        </Style>
        
        <Style TargetType="CheckBox">
            <Setter Property="Foreground" Value="White" />
            <Setter Property="FontSize" Value="15" />
            <Setter Property="Cursor" Value="Hand" />
            <Style.Resources>
                <Style TargetType="Border">
                    <Setter Property="CornerRadius" Value="3" />
                    <Setter Property="BorderBrush" Value="#3b82f6" />
                    <Setter Property="BorderThickness" Value="2" />
                    <Setter Property="Background" Value="#1e293b" />
                </Style>
            </Style.Resources>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Foreground" Value="#60a5fa" />
                </Trigger>
            </Style.Triggers>
        </Style>
    </Window.Resources>
    <Border Padding="20" Background="#131d31" CornerRadius="18">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <ScrollViewer VerticalScrollBarVisibility="Auto" MaxHeight="600">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="*" />
                    </Grid.ColumnDefinitions>

                    <!-- Left Column -->
                    <StackPanel Grid.Column="0">
                        <!-- Ordner & Batch Section -->
                        <TextBlock Text="Ordner &amp; Batch" FontSize="22" FontWeight="SemiBold" />
                        <TextBlock Text="Passe hier Quelle, Ziel und Cache-Limit an." Margin="0,4,0,18" Foreground="#cbd5f5" TextWrapping="Wrap" FontSize="13" />

                    <TextBlock Text="Quellordner" FontWeight="SemiBold" FontSize="14" />
                    <DockPanel Margin="0,4,0,12">
                        <Button Content="Ordner wählen"
                                Command="{Binding BrowseSourceFolderCommand}"
                                Margin="0,0,10,0"
                                Padding="12,6"
                                FontSize="13"
                                DockPanel.Dock="Right" />
                        <TextBox Text="{Binding SourceFolder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Padding="10"
                                 FontSize="13"
                                 IsReadOnly="True" />
                    </DockPanel>

                    <TextBlock Text="Zielbasisordner" FontWeight="SemiBold" FontSize="14" />
                    <DockPanel Margin="0,4,0,12">
                        <Button Content="Ordner wählen"
                                Command="{Binding BrowseDestinationFolderCommand}"
                                Margin="0,0,10,0"
                                Padding="12,6"
                                FontSize="13"
                                DockPanel.Dock="Right" />
                        <TextBox Text="{Binding DestinationBaseFolder, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Padding="10"
                                 FontSize="13"
                                 IsReadOnly="True" />
                    </DockPanel>

                    <StackPanel Margin="0,4,0,10">
                        <TextBlock Text="Unterordnername" FontWeight="SemiBold" FontSize="14" />
                        <TextBox Text="{Binding DestinationFolderName, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Padding="10"
                                 FontSize="13"
                                 Margin="0,4,0,0" />
                    </StackPanel>

                    <CheckBox Content="Unterordner durchsuchen"
                              FontSize="13"
                              Margin="0,0,0,10"
                              IsChecked="{Binding IncludeSubfolders}" />

                    <StackPanel Margin="0,4,0,0">
                        <TextBlock Text="Cache-Limit (MB)" FontWeight="SemiBold" FontSize="14" />
                        <TextBox Width="160"
                                 HorizontalAlignment="Left"
                                 Text="{Binding PreviewCacheLimitMb, UpdateSourceTrigger=LostFocus}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Padding="10"
                                 FontSize="13"
                                 Margin="0,4,0,0" />
                    </StackPanel>
                </StackPanel>

                    <!-- Right Column -->
                    <StackPanel Grid.Column="2">
                        <!-- Performance Options Section -->
                        <TextBlock Text="Performance-Optionen" FontSize="22" FontWeight="SemiBold" />
                        <TextBlock Text="Optimiere die Transfer-Geschwindigkeit und Fehlerbehandlung." Margin="0,4,0,18" Foreground="#cbd5f5" TextWrapping="Wrap" FontSize="13" />

                    <StackPanel Margin="0,0,0,10">
                        <TextBlock Text="Buffer-Größe (MB)" FontWeight="SemiBold" FontSize="14" />
                        <ComboBox SelectedItem="{Binding BufferSizeMB}"
                                  Style="{StaticResource DialogComboBoxStyle}"
                                  Padding="10"
                                  FontSize="13"
                                  Margin="0,4,0,0"
                                  HorizontalAlignment="Left"
                                  Width="160">
                            <sys:Int32>8</sys:Int32>
                            <sys:Int32>16</sys:Int32>
                            <sys:Int32>32</sys:Int32>
                            <sys:Int32>64</sys:Int32>
                        </ComboBox>
                    </StackPanel>

                    <CheckBox Content="Dynamische Parallelität aktivieren (empfohlen)"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding DynamicConcurrencyEnabled}" />

                    <StackPanel Margin="0,0,0,10">
                        <TextBlock Text="Kleindateien Schwellenwert (MB)" FontWeight="SemiBold" FontSize="14" />
                        <TextBox Width="160"
                                 HorizontalAlignment="Left"
                                 Text="{Binding SmallFileSizeThresholdMB, UpdateSourceTrigger=LostFocus}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Padding="10"
                                 FontSize="13"
                                 Margin="0,4,0,0" />
                    </StackPanel>

                    <CheckBox Content="Automatische Aktualisierung aktivieren"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding AutoRefreshEnabled}" />

                    <CheckBox Content="Verschieben-Bestätigung anzeigen"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding ShowMoveConfirmation}" />

                    <CheckBox Content="Rollback bei Fehler aktivieren (sicher)"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding EnableRollbackOnError}" />

                    <CheckBox Content="Warnung für langsame Übertragung anzeigen"
                              FontSize="13"
                              Margin="0,0,0,12"
                              IsChecked="{Binding ShowSlowTransferWarning}" />

                    <StackPanel Margin="0,4,0,18">
                        <TextBlock Text="Design-Modus" FontWeight="SemiBold" FontSize="14" />
                        <ComboBox Style="{StaticResource DialogComboBoxStyle}"
                                  SelectedItem="{Binding ThemeMode}"
                                  Padding="10"
                                  FontSize="13"
                                  HorizontalAlignment="Left"
                                  Width="160"
                                  Margin="0,4,0,0">
                            <sys:String>Light</sys:String>
                            <sys:String>Dark</sys:String>
                            <sys:String>System</sys:String>
                        </ComboBox>
                    </StackPanel>

                    <!-- Job-Queue Options Section -->
                    <TextBlock Text="Job-Warteschlange" FontSize="22" FontWeight="SemiBold" Margin="0,24,0,0" />
                    <TextBlock Text="Einstellungen für die Job-Verarbeitung und Benachrichtigungen." Margin="0,4,0,18" Foreground="#cbd5f5" TextWrapping="Wrap" FontSize="13" />

                    <CheckBox Content="Fehlgeschlagene Dateien automatisch wiederholen"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding AutoRetryFailedFiles}" />

                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="Max. Wiederholungen pro Datei" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4" />
                        <TextBox Text="{Binding MaxRetries, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Width="100"
                                 HorizontalAlignment="Left"
                                 TextAlignment="Center" />
                    </StackPanel>

                    <CheckBox Content="Benachrichtigung bei Job-Abschluss anzeigen"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding ShowJobCompletionNotification}" />

                    <CheckBox Content="Abgeschlossene Jobs automatisch löschen"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding AutoClearCompletedJobs}" />

                    <StackPanel Margin="0,0,0,12" Opacity="{Binding AutoClearCompletedJobs, Converter={StaticResource BoolToOpacity}}">
                        <TextBlock Text="Löschen nach (Stunden)" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4" />
                        <TextBox Text="{Binding AutoClearCompletedJobsHours, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Width="100"
                                 HorizontalAlignment="Left"
                                 TextAlignment="Center" />
                    </StackPanel>

                    <CheckBox Content="Job-Historie speichern (Persistierung)"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding EnableJobPersistence}" />

                    <StackPanel Margin="0,0,0,12">
                        <TextBlock Text="Maximale gleichzeitige Jobs" FontWeight="SemiBold" FontSize="13" Margin="0,0,0,4" />
                        <TextBox Text="{Binding MaxConcurrentJobs, UpdateSourceTrigger=PropertyChanged}"
                                 Style="{StaticResource DialogInputTextBoxStyle}"
                                 Width="100"
                                 HorizontalAlignment="Left"
                                 TextAlignment="Center" />
                    </StackPanel>

                    <!-- Label Printing Section -->
                    <TextBlock Text="Etikettendruck" FontSize="22" FontWeight="SemiBold" Margin="0,24,0,0" />
                    <TextBlock Text="Konfiguriere den Drucker und das Format für Etiketten." Margin="0,4,0,18" Foreground="#cbd5f5" TextWrapping="Wrap" FontSize="13" />

                    <StackPanel Margin="0,0,0,10">
                        <TextBlock Text="Etikettendrucker" FontWeight="SemiBold" FontSize="14" />
                        <ComboBox ItemsSource="{Binding AvailablePrinters}"
                                  SelectedItem="{Binding LabelPrinterName}"
                                  Style="{StaticResource DialogComboBoxStyle}"
                                  Padding="10"
                                  FontSize="13"
                                  HorizontalAlignment="Left"
                                  MinWidth="200"
                                  Margin="0,4,0,0">
                        </ComboBox>
                    </StackPanel>

                    <StackPanel Margin="0,0,0,10">
                        <TextBlock Text="Etikettenformat" FontWeight="SemiBold" FontSize="14" />
                        <ComboBox ItemsSource="{Binding AvailableLabelFormats}"
                                  SelectedItem="{Binding LabelFormat}"
                                  Style="{StaticResource DialogComboBoxStyle}"
                                  Padding="10"
                                  FontSize="13"
                                  HorizontalAlignment="Left"
                                  MinWidth="250"
                                  Margin="0,4,0,0">
                        </ComboBox>
                    </StackPanel>

                    <CheckBox Content="Automatisch nach Verschieben drucken"
                              FontSize="13"
                              Margin="0,0,0,8"
                              IsChecked="{Binding AutoPrintLabelsEnabled}" />

                    <CheckBox Content="Barcode auf Etikett anzeigen"
                              FontSize="13"
                              Margin="0,0,0,12"
                              IsChecked="{Binding IncludeBarcodeOnLabel}" />

                    <!-- System Options Section -->
                    <TextBlock Text="System" FontSize="22" FontWeight="SemiBold" Margin="0,24,0,0" />
                    <TextBlock Text="Systemeinstellungen für Programmstart und -verhalten." Margin="0,4,0,18" Foreground="#cbd5f5" TextWrapping="Wrap" FontSize="13" />

                    <CheckBox Content="Mit Windows starten"
                              FontSize="13"
                              Margin="0,0,0,12"
                              IsChecked="{Binding StartWithWindows}" />
                    </StackPanel>
                </Grid>
            </ScrollViewer>

            <StackPanel Grid.Row="1" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,16,0,0">
                <Button Content="Abbrechen"
                        Width="130"
                        Padding="12,6"
                        FontSize="13"
                        Margin="0,0,12,0"
                        Click="OnCancelClicked" />
                <Button Content="Speichern"
                        Width="150"
                        Padding="12,6"
                        FontSize="13"
                        IsDefault="True"
                        Click="OnSaveClicked" />
            </StackPanel>
        </Grid>
    </Border>
</Window>
